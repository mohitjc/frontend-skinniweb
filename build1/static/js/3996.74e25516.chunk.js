"use strict";(self.webpackChunkskinniweb=self.webpackChunkskinniweb||[]).push([[3996,6332,3899,9551,5058],{31554:(e,t,n)=>{n.r(t),n.d(t,{default:()=>g});var o=n(65043),a=n(68513),s=(n(71251),n(68090)),i=n(33371),l=n(73216),r=n(60482),u=n(86213),c=n(20445),d=n(83003),p=n(30064),f=n.n(p),v=n(70579);const g=()=>{var e,t;const n=(0,d.d4)((e=>e.user)),p=null===(e=n.connectionsDetails)||void 0===e||null===(t=e.find((e=>"calendly"==e.type&&e.connected)))||void 0===t?void 0:t.refreshToken,[g,h]=(0,o.useState)(""),[y,A]=(0,o.useState)({page:1,count:10,search:""}),[m,w]=(0,o.useState)([]),[k,C]=(0,o.useState)(0),[B,_]=(0,o.useState)(),[x,D]=(0,o.useState)(!1),[S,T]=(0,o.useState)(),[$,b]=(0,o.useState)([]),[F,z]=(0,o.useState)([]),E=(0,l.Zp)(),I=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={...y,...e,user:null===S||void 0===S?void 0:S.uri,Authorization:g,status:"active"};if(!t.Authorization)return;t.eventType&&(t.event_type=t.eventType),t.sortBy&&(t.sort=t.sortBy.replace(" ",":")),t.startDate&&(t.min_start_time=new Date(t.startDate).toUTCString(),t.max_start_time=new Date(t.endDate).toUTCString()),D(!0);a.A.get("https://api.calendly.com/scheduled_events",t).then((e=>{if(e.collection){let t=e.collection.map((e=>(e.id=e.uri,e)));w(t),C(e.pagination.count)}D(!1)}))},U=()=>{let e={startDate:"",endDate:"",platform:"",search:"",status:"",eventType:"",page:1,role:""};A({...y,...e}),I({...e})},j=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=null===n||void 0===n?void 0:n.permissions;null===t||void 0===t||t[e];return!0};(0,o.useEffect)((()=>{n&&n.loggedIn&&g&&((0,s.A)(!0),a.A.get("https://api.calendly.com/users/me",{Authorization:g}).then((e=>{if((0,s.A)(!1),e.resource){let t=e.resource;T(t)}})))}),[n,g]),(0,o.useEffect)((()=>{if(n&&n.loggedIn){if(!p)return;(0,s.A)(!0),a.A.get("calendly/refresh_token",{refresh_token:p}).then((e=>{(0,s.A)(!1),e.success&&h(e.data.access_token)}))}}),[p]);return(0,o.useEffect)((()=>{S&&(g&&a.A.get("https://api.calendly.com/event_types",{Authorization:g,organization:null===S||void 0===S?void 0:S.current_organization}).then((e=>{if(e.collection){let t=e.collection.map((e=>({...e,id:e.uri})));b(t)}})),I(),a.A.get("calendly/upcoming/events").then((e=>{var t,n,o;e.success&&(z(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.collection),_(null===e||void 0===e||null===(n=e.data)||void 0===n||null===(o=n.pagination)||void 0===o?void 0:o.total_count))})))}),[S]),(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(i.default,{eventTypes:$,me:S,Authorization:g,edit:e=>{E(`/${c.default.url}/edit/${e}`)},view:e=>{let t=`/${c.default.url}/detail/${e}`;E(t)},clear:U,sortClass:e=>{let t="fa-sort";return y.key==e&&"asc"==y.sorder?t="fa-sort-up":y.key==e&&"desc"==y.sorder&&(t="fa-sort-down"),"fa "+t},sorting:e=>{let t="asc";y.key==e&&(t="asc"==y.sorder?"desc":"asc");let n=`${e} ${t}`;A({...y,sortBy:n,key:e,sorder:t}),I({sortBy:n,key:e,sorder:t})},isAllow:j,count:e=>{A({...y,count:e}),I({...y,count:e})},pageChange:e=>{A({...y,page:e}),I({page:e})},deleteItem:e=>{f().fire({title:"Are you sure?",text:"Do you want to delete this",icon:"warning",showCancelButton:!0,confirmButtonColor:"#0065FF",cancelButtonColor:"#d33",confirmButtonText:"Yes"}).then((t=>{t.isConfirmed&&((0,s.A)(!0),a.A.delete(c.default.deleteApi,{id:e}).then((e=>{e.success&&U(),(0,s.A)(!1)})))}))},filters:y,setFilter:A,filter:function(){let e={page:1,...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}};A({...y,...e}),I({...e})},loaging:x,data:m,total:k,statusChange:e=>{if(!j(`edit${c.default.check}`))return;let t="active";"active"==e.status&&(t="deactive"),f().fire({title:"Are you sure?",text:`Do you want to ${"active"==t?"Activate":"Inactivate"} this user?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#0065FF",cancelButtonColor:"#d33",confirmButtonText:"Yes"}).then((n=>{n.isConfirmed&&((0,s.A)(!0),a.A.put(c.default.statusApi,{id:e.id,status:t}).then((e=>{e.success&&I(),(0,s.A)(!1)})))}))},changestatus:e=>{A({...y,status:e,page:1}),I({status:e,page:1})},exportfun:async()=>{const e=null===n||void 0===n?void 0:n.access_token,t=await(0,u.A)({method:"get",url:`${r.A.api}api/export/excel`,responseType:"blob",body:{token:e}});var o=new Blob([t.data],{type:t.headers["content-type"]});const a=document.createElement("a");a.href=window.URL.createObjectURL(o),a.download=`${c.default.title}.xlsx`,a.click()},getRolesData:e=>{A({...y,role:e,page:1}),I({role:e,page:1})},uploadFile:e=>{let t=e.target.files,n=null===t||void 0===t?void 0:t.item(0);n&&((0,s.A)(!0),a.A.postFormFileData("user/import-users",{file:n}).then((e=>{e.success,(0,s.A)(!1)})))},upcomingEvents:F,eventCount:B})})}}}]);
//# sourceMappingURL=3996.74e25516.chunk.js.map